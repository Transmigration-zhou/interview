## 1.JVM 内存区域

[推荐视频](https://www.bilibili.com/video/BV12t411u726)

（1）JVM 内存区域共分为5个区：Java虚拟机栈、本地方法栈、堆、程序计数器、方法区（元空间）
（2）各个区各自的作用：
	a. 本地方法栈：用于管理本地方法的调用，里面并没有我们写的代码逻辑，其由native修饰，由 C 语言实现。
	b. 程序计数器：它是一块很小的内存空间，主要用来==记录正在执行的虚拟机字节码指令的地址（如果正在执行的是本地方法则为空）==。
	c. 方法区（从 JDK 1.8 开始叫元空间）：用于存放已被加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。
	d. Java 虚拟机栈：用于存储局部变量表、操作数栈、常量池引用等信息。（栈里面存的是地址，实际指向的是堆里面的对象）
	e. 堆：Java 虚拟机中内存最大的一块，是被所有线程共享的，几乎所有的对象实例都在这里分配内存；
（3）线程私有、公有
	a.线程私有：每个线程在开辟、运行的过程中会单独创建这样的一份内存，有多少个线程可能有多少个内存
		Java虚拟机栈、本地方法栈、程序计数器是线程私有的
	b.线程全局共享的
		堆和方法区
（4）栈虽然方法运行完毕了之后被清空了，但是==堆上面的还没有被清空==，所以引出了GC（垃圾回收），不能立马删除，因为不知道是否还有其它的也是引用了当前的地址来访问的

![img](https://gitee.com/Transmigration_zhou/pic/raw/master/img/20220228162829.png)



## 2.使用PC寄存器存储字节码指令地址有什么用呢?（为什么使用PC寄存器记录当前线程的执行地址？）

- 因为CPU需要不停的切换各个线程，这时候切换回来以后，就得知道接着从哪开始继续执行
- JVM的字节码解释器就需要通过改变PC寄存器的值来明确下一条应该执行什么样的字节码指令。



## 3.PC寄存器为什么会被设定为线程私有?

宏观上并行执行的线程微观上并发执行，在执行过程中会不断切换，==为了能够准确地记录各个线程正在执行的当前字节码指令地址，最好的办法是为每一个线程都分配一个PC寄存器==。